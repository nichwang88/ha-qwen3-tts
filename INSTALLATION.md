# Qwen3 TTS é›†æˆå®‰è£…æŒ‡å—

å®Œæ•´çš„å®‰è£…å’Œé…ç½®æ­¥éª¤ã€‚

## ç›®å½•

1. [å…ˆå†³æ¡ä»¶](#å…ˆå†³æ¡ä»¶)
2. [éƒ¨ç½² Qwen3 TTS æœåŠ¡å™¨](#éƒ¨ç½²-qwen3-tts-æœåŠ¡å™¨)
3. [å®‰è£…é›†æˆ](#å®‰è£…é›†æˆ)
4. [é…ç½®é›†æˆ](#é…ç½®é›†æˆ)
5. [éªŒè¯å®‰è£…](#éªŒè¯å®‰è£…)
6. [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)

---

## å…ˆå†³æ¡ä»¶

### Home Assistant è¦æ±‚

- **Home Assistant ç‰ˆæœ¬**: 2024.1.0 æˆ–æ›´é«˜
- **ç½‘ç»œ**: èƒ½å¤Ÿè®¿é—® Qwen3 TTS æœåŠ¡å™¨ï¼ˆæœ¬åœ°ç½‘ç»œæˆ–åŒä¸€ä¸»æœºï¼‰

### Qwen3 TTS æœåŠ¡å™¨è¦æ±‚

- **ç¡¬ä»¶æ¨è**:
  - NVIDIA GPUï¼ˆ8GB+ VRAMï¼‰æ¨è
  - æˆ– CPU æ¨¡å¼ï¼ˆ8GB+ RAMï¼Œé€Ÿåº¦è¾ƒæ…¢ï¼‰
- **ç£ç›˜ç©ºé—´**: 10GB+ï¼ˆç”¨äºæ¨¡å‹ç¼“å­˜ï¼‰
- **Docker**: å·²å®‰è£… Docker å’Œ Docker Compose

---

## éƒ¨ç½² Qwen3 TTS æœåŠ¡å™¨

### é€‰é¡¹ A: ä½¿ç”¨é¢„é…ç½®çš„ Docker éƒ¨ç½²ï¼ˆæ¨èï¼‰

1. **ä¸‹è½½éƒ¨ç½²æ–‡ä»¶**

   ```bash
   cd ~
   git clone https://github.com/nichwang88/qwen3-tts-docker.git
   cd qwen3-tts-docker
   ```

2. **å¯åŠ¨æœåŠ¡**

   ```bash
   # å¯åŠ¨æœåŠ¡ï¼ˆé¦–æ¬¡å¯åŠ¨ä¼šä¸‹è½½æ¨¡å‹ï¼Œéœ€è¦ 5-15 åˆ†é’Ÿï¼‰
   docker compose up -d

   # æŸ¥çœ‹å¯åŠ¨æ—¥å¿—
   docker compose logs -f
   ```

3. **ç­‰å¾…æ¨¡å‹ä¸‹è½½å®Œæˆ**

   æ—¥å¿—ä¸­çœ‹åˆ°ä»¥ä¸‹ä¿¡æ¯è¡¨ç¤ºæˆåŠŸï¼š
   ```
   âœ… æ¨¡å‹åŠ è½½å®Œæˆï¼
   âœ… å¯åŠ¨ Qwen3-TTS API Server...
   INFO:     Uvicorn running on http://0.0.0.0:7860
   ```

4. **éªŒè¯æœåŠ¡**

   ```bash
   # å¥åº·æ£€æŸ¥
   curl http://localhost:7860/health

   # é¢„æœŸè¾“å‡º:
   # {"status":"healthy","model_loaded":true}

   # æµ‹è¯• TTS
   curl -X POST "http://localhost:7860/api/tts?text=ä½ å¥½ä¸–ç•Œ" -o test.wav
   ```

### é€‰é¡¹ B: æ‰‹åŠ¨éƒ¨ç½²

å¦‚æœéœ€è¦è‡ªå®šä¹‰éƒ¨ç½²ï¼Œè¯·å‚è€ƒ [Qwen3 TTS è¯¦ç»†éƒ¨ç½²æŒ‡å—](https://github.com/nichwang88/qwen3-tts-docker/blob/main/README.md)ã€‚

---

## å®‰è£…é›†æˆ

### æ–¹æ³• 1: é€šè¿‡ HACS å®‰è£…ï¼ˆæ¨èï¼‰

#### æ­¥éª¤ 1: æ·»åŠ è‡ªå®šä¹‰ä»“åº“

1. æ‰“å¼€ Home Assistant
2. è¿›å…¥ **HACS** â†’ **Integrations**
3. ç‚¹å‡»å³ä¸Šè§’ **â‹®** èœå•
4. é€‰æ‹© **Custom repositories**
5. æ·»åŠ ä»“åº“:
   - **Repository**: `https://github.com/nichwang88/ha-qwen3-tts`
   - **Category**: `Integration`
6. ç‚¹å‡» **Add**

#### æ­¥éª¤ 2: å®‰è£…é›†æˆ

1. åœ¨ HACS é›†æˆé¡µé¢æœç´¢ "**Qwen3 TTS**"
2. ç‚¹å‡»é›†æˆå¡ç‰‡
3. ç‚¹å‡» **Download**
4. é€‰æ‹©æœ€æ–°ç‰ˆæœ¬
5. ç‚¹å‡» **Download**

#### æ­¥éª¤ 3: é‡å¯ Home Assistant

1. è¿›å…¥ **è®¾ç½®** â†’ **ç³»ç»Ÿ**
2. ç‚¹å‡» **é‡å¯** â†’ **å¿«é€Ÿé‡æ–°åŠ è½½**
3. ç­‰å¾…é‡å¯å®Œæˆ

### æ–¹æ³• 2: æ‰‹åŠ¨å®‰è£…

#### æ­¥éª¤ 1: ä¸‹è½½é›†æˆæ–‡ä»¶

1. è®¿é—® [Releases é¡µé¢](https://github.com/nichwang88/ha-qwen3-tts/releases)
2. ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„ `qwen3_tts.zip`
3. è§£å‹æ–‡ä»¶

#### æ­¥éª¤ 2: å¤åˆ¶åˆ° Home Assistant

```bash
# å‡è®¾ä½ çš„ HA é…ç½®ç›®å½•åœ¨ /config
cd /config

# åˆ›å»º custom_components ç›®å½•ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
mkdir -p custom_components

# å¤åˆ¶é›†æˆæ–‡ä»¶
cp -r /path/to/extracted/qwen3_tts custom_components/
```

#### æ­¥éª¤ 3: éªŒè¯æ–‡ä»¶ç»“æ„

ç¡®ä¿æ–‡ä»¶ç»“æ„å¦‚ä¸‹ï¼š

```
/config/
â””â”€â”€ custom_components/
    â””â”€â”€ qwen3_tts/
        â”œâ”€â”€ __init__.py
        â”œâ”€â”€ manifest.json
        â”œâ”€â”€ config_flow.py
        â”œâ”€â”€ const.py
        â”œâ”€â”€ strings.json
        â”œâ”€â”€ tts.py
        â””â”€â”€ translations/
            â”œâ”€â”€ en.json
            â””â”€â”€ zh-Hans.json
```

#### æ­¥éª¤ 4: é‡å¯ Home Assistant

```bash
# ä½¿ç”¨ CLI
ha core restart

# æˆ–é€šè¿‡ UI: è®¾ç½® â†’ ç³»ç»Ÿ â†’ é‡å¯
```

---

## é…ç½®é›†æˆ

### æ­¥éª¤ 1: æ·»åŠ é›†æˆ

1. è¿›å…¥ **è®¾ç½®** â†’ **è®¾å¤‡ä¸æœåŠ¡**
2. ç‚¹å‡»å³ä¸‹è§’ **+ æ·»åŠ é›†æˆ**
3. åœ¨æœç´¢æ¡†è¾“å…¥ "**Qwen3 TTS**"
4. ç‚¹å‡» **Qwen3 TTS** é›†æˆ

### æ­¥éª¤ 2: é…ç½®å‚æ•°

å¡«å†™ä»¥ä¸‹ä¿¡æ¯ï¼š

| å­—æ®µ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| **ä¸»æœºåœ°å€** | Qwen3 TTS æœåŠ¡å™¨çš„ IP åœ°å€æˆ–ä¸»æœºå | `192.168.1.100` æˆ– `localhost` |
| **ç«¯å£** | æœåŠ¡å™¨ç«¯å£ | `7860` |
| **é»˜è®¤è¯­é€Ÿ** | é»˜è®¤æ’­æŠ¥è¯­é€Ÿï¼ˆ0.5-2.0ï¼‰ | `1.0` |

**é…ç½®ç¤ºä¾‹**ï¼š

- **åŒä¸€å°æœºå™¨è¿è¡Œ**:
  - ä¸»æœº: `localhost` æˆ– `127.0.0.1`
  - ç«¯å£: `7860`

- **ä¸åŒæœºå™¨è¿è¡Œ**:
  - ä¸»æœº: æœåŠ¡å™¨çš„å±€åŸŸç½‘ IPï¼ˆå¦‚ `192.168.1.100`ï¼‰
  - ç«¯å£: `7860`

### æ­¥éª¤ 3: æäº¤é…ç½®

1. ç‚¹å‡» **æäº¤**
2. ç­‰å¾…è¿æ¥éªŒè¯
3. å¦‚æœæˆåŠŸï¼Œé›†æˆä¼šæ˜¾ç¤ºåœ¨è®¾å¤‡ä¸æœåŠ¡åˆ—è¡¨ä¸­

### é…ç½®æˆåŠŸæ ‡å¿—

âœ… **è®¾å¤‡ä¸æœåŠ¡**é¡µé¢æ˜¾ç¤º "Qwen3 TTS (YOUR_HOST:7860)"
âœ… **å®ä½“**é¡µé¢å‡ºç° `tts.qwen3_tts`

---

## éªŒè¯å®‰è£…

### 1. æ£€æŸ¥å®ä½“

1. è¿›å…¥ **è®¾ç½®** â†’ **è®¾å¤‡ä¸æœåŠ¡**
2. æ‰¾åˆ° **Qwen3 TTS** é›†æˆ
3. ç‚¹å‡»æŸ¥çœ‹å®ä½“ï¼Œåº”è¯¥çœ‹åˆ° `tts.qwen3_tts`

### 2. æµ‹è¯• TTS æœåŠ¡

ä½¿ç”¨å¼€å‘è€…å·¥å…·æµ‹è¯•ï¼š

1. è¿›å…¥ **å¼€å‘è€…å·¥å…·** â†’ **æœåŠ¡**
2. é€‰æ‹©æœåŠ¡: `tts.speak`
3. é€‰æ‹©ç›®æ ‡: `tts.qwen3_tts`
4. å¡«å†™æœåŠ¡æ•°æ®:

   ```yaml
   media_player_entity_id: media_player.YOUR_PLAYER
   message: "è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•"
   ```

5. ç‚¹å‡» **è°ƒç”¨æœåŠ¡**
6. åº”è¯¥å¬åˆ°è¯­éŸ³æ’­æŠ¥

### 3. æµ‹è¯•è‡ªå®šä¹‰é€‰é¡¹

æµ‹è¯•è¯­é€Ÿè°ƒèŠ‚ï¼š

```yaml
media_player_entity_id: media_player.YOUR_PLAYER
message: "è¿™æ˜¯å¿«é€Ÿæ’­æŠ¥æµ‹è¯•"
options:
  speed: 1.5
```

---

## æ•…éšœæ’é™¤

### é—®é¢˜ 1: æ— æ³•æ·»åŠ é›†æˆ

**ç—‡çŠ¶**: ç‚¹å‡»"æäº¤"åæ˜¾ç¤º"æ— æ³•è¿æ¥åˆ° Qwen3 TTS æœåŠ¡å™¨"

**è§£å†³æ–¹æ¡ˆ**:

1. **éªŒè¯æœåŠ¡å™¨è¿è¡ŒçŠ¶æ€**:
   ```bash
   curl http://YOUR_HOST:7860/health
   ```

   é¢„æœŸå“åº”: `{"status":"healthy","model_loaded":true}`

2. **æ£€æŸ¥ç½‘ç»œè¿é€šæ€§**:
   ```bash
   # ä» HA ä¸»æœºæµ‹è¯•
   ping YOUR_SERVER_IP
   telnet YOUR_SERVER_IP 7860
   ```

3. **æ£€æŸ¥é˜²ç«å¢™**:
   ```bash
   # å…è®¸ç«¯å£ 7860
   sudo ufw allow 7860
   ```

4. **æŸ¥çœ‹ HA æ—¥å¿—**:
   - **è®¾ç½®** â†’ **ç³»ç»Ÿ** â†’ **æ—¥å¿—**
   - æœç´¢ "qwen3_tts"

### é—®é¢˜ 2: TTS è°ƒç”¨æˆåŠŸä½†æ— å£°éŸ³

**ç—‡çŠ¶**: æœåŠ¡è°ƒç”¨è¿”å›æˆåŠŸï¼Œä½†æ²¡æœ‰è¯­éŸ³æ’­æ”¾

**è§£å†³æ–¹æ¡ˆ**:

1. **éªŒè¯ media_player çŠ¶æ€**:
   ```yaml
   # å¼€å‘è€…å·¥å…· â†’ çŠ¶æ€
   # æœç´¢ä½ çš„ media_player å®ä½“
   # ç¡®è®¤ state ä¸æ˜¯ "unavailable"
   ```

2. **æµ‹è¯• media_player**:
   ```yaml
   service: media_player.play_media
   target:
     entity_id: media_player.YOUR_PLAYER
   data:
     media_content_type: music
     media_content_id: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3"
   ```

3. **æ£€æŸ¥éŸ³é‡**:
   ```yaml
   service: media_player.volume_set
   target:
     entity_id: media_player.YOUR_PLAYER
   data:
     volume_level: 0.5
   ```

4. **æŸ¥çœ‹ HA æ—¥å¿—**è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯

### é—®é¢˜ 3: è‡ªå®šä¹‰éŸ³è‰²ä¸å¯ç”¨

**ç—‡çŠ¶**: ä½¿ç”¨ `speaker` é€‰é¡¹æ—¶æŠ¥é”™

**è§£å†³æ–¹æ¡ˆ**:

1. **æ£€æŸ¥å¯ç”¨éŸ³è‰²**:
   ```bash
   curl http://YOUR_HOST:7860/api/list_speakers
   ```

2. **ä¸Šä¼ éŸ³è‰²æ ·æœ¬**:
   ```bash
   curl -X POST "http://YOUR_HOST:7860/api/upload_speaker?name=test_voice" \
     -F "file=@/path/to/voice.wav"
   ```

3. **éŸ³é¢‘è¦æ±‚**:
   - æ ¼å¼: WAV/MP3/FLAC
   - æ—¶é•¿: 3-10 ç§’
   - è´¨é‡: æ¸…æ™°äººå£°ï¼Œæ— èƒŒæ™¯å™ªéŸ³

### é—®é¢˜ 4: é›†æˆé‡å¯åæ¶ˆå¤±

**ç—‡çŠ¶**: Home Assistant é‡å¯åé›†æˆä¸è§äº†

**è§£å†³æ–¹æ¡ˆ**:

1. **æ£€æŸ¥æ–‡ä»¶æƒé™**:
   ```bash
   ls -la /config/custom_components/qwen3_tts/
   # ç¡®ä¿ HA ç”¨æˆ·æœ‰è¯»å–æƒé™
   ```

2. **æŸ¥çœ‹å¯åŠ¨æ—¥å¿—**:
   ```bash
   # Home Assistant å¯åŠ¨æ—¥å¿—
   journalctl -u home-assistant -f
   ```

3. **éªŒè¯æ–‡ä»¶å®Œæ•´æ€§**:
   ```bash
   # ç¡®ä¿æ‰€æœ‰å¿…éœ€æ–‡ä»¶å­˜åœ¨
   ls /config/custom_components/qwen3_tts/
   # åº”è¯¥çœ‹åˆ°: __init__.py, manifest.json, config_flow.py, ç­‰
   ```

### é—®é¢˜ 5: HACS æ‰¾ä¸åˆ°é›†æˆ

**ç—‡çŠ¶**: åœ¨ HACS ä¸­æœç´¢ä¸åˆ° Qwen3 TTS

**è§£å†³æ–¹æ¡ˆ**:

1. **ç¡®è®¤å·²æ·»åŠ è‡ªå®šä¹‰ä»“åº“**:
   - HACS â†’ Integrations â†’ â‹® â†’ Custom repositories
   - æ£€æŸ¥æ˜¯å¦æœ‰ `https://github.com/nichwang88/ha-qwen3-tts`

2. **åˆ·æ–° HACS**:
   - HACS â†’ â‹® â†’ Reload

3. **æ‰‹åŠ¨å®‰è£…**ï¼ˆå¤‡é€‰æ–¹æ¡ˆï¼‰

---

## ä¸‹ä¸€æ­¥

å®‰è£…å®Œæˆåï¼Œä½ å¯ä»¥ï¼š

1. ğŸ“– **é˜…è¯»ä½¿ç”¨ç¤ºä¾‹**: [README.md](README.md#ä½¿ç”¨ç¤ºä¾‹)
2. ğŸ­ **ä¸Šä¼ è‡ªå®šä¹‰éŸ³è‰²**: åˆ›å»ºä¸ªæ€§åŒ–è¯­éŸ³
3. ğŸ¤– **åˆ›å»ºè‡ªåŠ¨åŒ–**: å®ç°æ™ºèƒ½è¯­éŸ³æé†’
4. ğŸ“± **é…ç½® Lovelace**: æ·»åŠ  TTS æ§åˆ¶å¡ç‰‡

---

## è·å–å¸®åŠ©

- ğŸ“š **æ–‡æ¡£**: [å®Œæ•´æ–‡æ¡£](README.md)
- ğŸ› **é—®é¢˜åé¦ˆ**: [GitHub Issues](https://github.com/nichwang88/ha-qwen3-tts/issues)
- ğŸ’¬ **è®¨è®º**: [GitHub Discussions](https://github.com/nichwang88/ha-qwen3-tts/discussions)

---

**ç¥ä½¿ç”¨æ„‰å¿«ï¼** ğŸ‰
